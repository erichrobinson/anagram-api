let fs,MongoClient,isProper,sortByLetter;_a39‍.w("fs",[["default",["fs"],function(v){fs=v}]]);_a39‍.w("mongodb",[["MongoClient",["MongoClient"],function(v){MongoClient=v}]]);_a39‍.w("../utilities/helpers",[["isProper",["isProper"],function(v){isProper=v}],["sortByLetter",["sortByLetter"],function(v){sortByLetter=v}]]);



function generateSeedData() {
  return fs.readFileSync('./dictionaries/default.txt', 'utf8').split('\n').map(word => {
    if(word.length) {
      return {
        length: word.length,
        word: word,
        sorted: sortByLetter(word),
        isProper: isProper(word)
      }
    }
  })
}

MongoClient.connect('mongodb://localhost:27017', async (err, db) => {
  const anagramApi = db.db('anagram-api')

  try {
    await anagramApi.dropCollection('words')
    const result = await anagramApi.collection('words').insertMany(generateSeedData())
    const index = await anagramApi.collection('words').createIndex({ sorted: 1, isProper: 1 })
    console.log(`Number of documents inserted: ${result.insertedCount}\nIndex created: ${index}`)
  } catch(err) {
    console.error(`Error seeding DB: ${err}`)
  }

  db.close()
})
